# ğŸŸ¢ ì™„ë£Œ
# SPEC_HPSystem â€” ì²´ë ¥(HP) ë° ê²Œì„ì˜¤ë²„ ì‹œìŠ¤í…œ

## 1. ê°œìš”

| í•­ëª© | ë‚´ìš© |
|---|---|
| **Component Name** | `HPSystemComponent` |
| **ê¸°ëŠ¥ ìš”ì•½** | ìºë¦­í„°ë³„ ì •ìˆ˜ HP ê´€ë¦¬, í”¼ê²© ë¬´ì , ìœ„ê¸° ì•Œë¦¼, ê²Œì„ì˜¤ë²„ ì²˜ë¦¬ |
| **ê¸°íšì„œ ì°¸ì¡°** | `ê¸°íšì„œ/1.í•µì‹¬ ì‹œìŠ¤í…œ/[ì‹œìŠ¤í…œ] ì²´ë ¥(HP) ë° ê²Œì„ì˜¤ë²„ ì‹œìŠ¤í…œ.md` |
| **ëª¨ë“ˆí™” ë ˆì´ì–´** | `Combat` |

---

## 2. Execution Space

| ì²˜ë¦¬ ë‹¨ê³„ | ì‹¤í–‰ ê³µê°„ | ì„¤ëª… |
|---|---|---|
| í”¼ê²© íŒì • (ì¶©ëŒ) | `[server only]` | TriggerEnterë¡œ ë°ë¯¸ì§€ ìˆ˜ì‹  |
| HP ì°¨ê° ê³„ì‚° | `[server only]` | ë°ë¯¸ì§€ ê³µì‹ ì ìš©, ë¬´ì  ì²´í¬ |
| ë¬´ì  íƒ€ì´ë¨¸ | `[server only]` | `_TimerService`ë¡œ ë¬´ì  í•´ì œ |
| HPë°” ê°±ì‹ , ê¹œë¹¡ì„ | `[client only]` | Syncëœ HP ë³€ê²½ ê°ì§€ â†’ UI ì—°ì¶œ |
| ìœ„ê¸° ì•Œë¦¼ (ë¶‰ì€ ì ë©¸) | `[client only]` | HP ë¹„ìœ¨ ê³„ì‚° â†’ ì´í™íŠ¸ í† ê¸€ |
| ê²Œì„ì˜¤ë²„ UI | `[client only]` | HP â‰¤ 0 ê°ì§€ â†’ ê²°ê³¼ í™”ë©´ í˜¸ì¶œ |

---

## 3. Properties

| Property Name | Type | Sync | Default | ì„¤ëª… |
|---|---|---|---|---|
| `MaxHP` | `integer` | `Sync` | `100` | ìµœëŒ€ ì²´ë ¥ |
| `CurrentHP` | `integer` | `Sync` | `100` | í˜„ì¬ ì²´ë ¥ |
| `DamageReduction` | `integer` | `None` | `0` | í”¼í•´ ê°ì†Œ ìˆ˜ì¹˜ |
| `IsInvincible` | `boolean` | `Sync` | `false` | ë¬´ì  ìƒíƒœ ì—¬ë¶€ |
| `InvincibleDuration` | `number` | `None` | `1.0` | í”¼ê²© ë¬´ì  ì‹œê°„ (ì´ˆ) |
| `CriticalHPRatio` | `number` | `None` | `0.3` | ìœ„ê¸° ì•Œë¦¼ ê¸°ì¤€ ë¹„ìœ¨ |
| `IsDead` | `boolean` | `Sync` | `false` | ì‚¬ë§ ì—¬ë¶€ |

---

## 4. ì‚¬ìš© ì„œë¹„ìŠ¤ & API

| ì„œë¹„ìŠ¤/API | ìš©ë„ |
|---|---|
| `_TimerService` | ë¬´ì  ì‹œê°„ íƒ€ì´ë¨¸ |
| `TriggerComponent` | ì  íˆ¬ì‚¬ì²´/ëª¸í†µ ì¶©ëŒ ê°ì§€ |
| `SpriteRendererComponent` | ë¬´ì  ê¹œë¹¡ì„ ì—°ì¶œ |

---

## 5. ë¡œì§ íë¦„

### 5-1. í”¼ê²© ì²˜ë¦¬ (ì„œë²„)
1. TriggerEnter â†’ IsInvincible/IsDead ì²´í¬ â†’ ë°ë¯¸ì§€ ê³„ì‚° â†’ HP ì°¨ê°
2. ë¬´ì  í™œì„±í™” â†’ íƒ€ì´ë¨¸ë¡œ í•´ì œ

### 5-2. ì‚¬ë§ íŒì • (ì„œë²„)
- CurrentHP â‰¤ 0 â†’ IsDead = true â†’ CanMove = false â†’ ì¦‰ì‹œ ê²Œì„ì˜¤ë²„

### 5-3. í´ë¼ì´ì–¸íŠ¸ ì—°ì¶œ
- Sync ê°ì§€ â†’ HPë°”, ê¹œë¹¡ì„, ìœ„ê¸° ì ë©¸, ê²Œì„ì˜¤ë²„ UI

---

## 6. Maker ë°°ì¹˜ (Codex MCP ì‹¤í–‰) âš ï¸ í•„ìˆ˜ ê²€í† 

### 6-1. UI ì—”í‹°í‹° (`DefaultGroup.ui`)

í•´ë‹¹ ì—†ìŒ (HPë°”ëŠ” HUDComponent ê´€í• )

### 6-2. ë§µ ì—”í‹°í‹°

í•´ë‹¹ ì—†ìŒ

### 6-3. ê¸€ë¡œë²Œ/ëª¨ë¸

í•´ë‹¹ ì—†ìŒ

### 6-4. ì»´í¬ë„ŒíŠ¸ ë¶€ì°© ê´€ê³„

| ì—”í‹°í‹° ê²½ë¡œ | ë¶€ì°©í•  ì»´í¬ë„ŒíŠ¸ | ì„¤ì •í•  Property | ë¹„ê³  |
|---|---|---|---|
| Player Entity (Bootstrap ìë™) | `script.HPSystemComponent` | `MaxHP=100, CurrentHP=100` | Map01BootstrapComponentê°€ ìë™ ë¶€ì°© |

---

## 7. ì—°ë™ ì»´í¬ë„ŒíŠ¸

| ì»´í¬ë„ŒíŠ¸ | ë ˆì´ì–´ | ì—°ë™ ë°©ì‹ |
|---|---|---|
| `MovementComponent` | Core | `CanMove = false` â€” ì‚¬ë§ ì‹œ ì´ë™ ì°¨ë‹¨ |
| `TagManagerComponent` | Meta | HP ë°ì´í„° ìŠ¤ì™‘ |
| `FireSystemComponent` | Combat | ë°ë¯¸ì§€ ê³µì‹ì˜ ì  ê³µê²©ë ¥ ìˆ˜ì‹  |
| `LobbyFlowComponent` | Bootstrap | IsDead â†’ HandleStageFailedServer |

---

## 8. ì£¼ì˜/ìµœì í™” í¬ì¸íŠ¸

- HPëŠ” **ì •ìˆ˜(Integer)** â€” ê¸°íšì„œ í™•ì •
- ë¬´ì  ì¤‘ ì¶”ê°€ í”¼ê²© = íŒì • ìì²´ë¥¼ ë¬´ì‹œ
- ì‚¬ë§ í›„ ì¶”ê°€ í”¼ê²© = ë¬´ì‹œ

---

## 9. Codex êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `@Component` ì–´íŠ¸ë¦¬ë·°íŠ¸, `Combat` ë ˆì´ì–´
- [ ] `_GRUtil` ì‚¬ìš© (ì¤‘ë³µ ìœ í‹¸ ê¸ˆì§€)
- [ ] `[server only]` / `[client only]` ë¶„ë¦¬
- [ ] `nil`/`isvalid` ë°©ì–´ + `pcall` ë³´í˜¸
- [ ] **Maker ë°°ì¹˜ (Â§6) ì™„ë£Œ**
- [ ] `ê¸°íšì„œ/4.ë¶€ë¡/Code_Documentation.md` ì—…ë°ì´íŠ¸
- [ ] ì™„ë£Œ í›„ ìƒíƒœ `ğŸŸ¢ ì™„ë£Œ`ë¡œ ë³€ê²½

---

## ë©”íƒ€ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|---|---|
| **ì‘ì„±ì** | Antigravity (TD) |
| **ë‹´ë‹¹ì** | Codex |
| **ì‘ì„±ì¼** | 2026-02-18 |
| **ìƒíƒœ** | ğŸŸ¢ ì™„ë£Œ |
